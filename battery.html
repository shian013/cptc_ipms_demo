
<!DOCTYPE html>
<html lang='zh-Hant'>
<head>
<style>

</style>

<meta charset='UTF-8'>
<meta name='viewport' content='width=device-width, initial-scale=1.0'>
<title>電瓶詳細頁面</title>
<style>
    body { font-family: 'Microsoft JhengHei', sans-serif; margin: 0; padding: 0; }
    .outer-container { display: flex; flex-direction: column; position: relative; background-color: #2c2f38; color: white; font-weight: bold;}
    .tab-bar { display: flex; align-items: flex-end; gap: 10px; border-bottom: 1px solid #ccc; background-color: #2c2f38; height: auto; padding: 5px; line-height: normal; margin-bottom: 0; padding-bottom: 0;}
    .bar-tab { display: flex; align-items: center; background-color: #f0f0f0; color: #333; padding: 8px 12px; border-radius: 4px 4px 0 0; font-weight: bold; bottom: 0; }
    .bar-tab .close-btn { width: 20px; height: 20px; border-radius: 50%; border: 1px solid #333; background-color: #333; color: #fff; font-size: 12px; cursor: pointer; margin-left: 8px; display: flex; justify-content: center; align-items: center; }
    .tabs { display: flex; gap: 10px; margin: 10px 20px; }
    .tab { padding: 8px 15px; background-color: #ddd; cursor: pointer; border-radius: 4px; }
    .tab.active { background-color: #150202; font-weight: bold; color:#fff }
    .content-row { display: grid; grid-template-columns: auto 180px; gap: 20px; margin: 20px; align-items: start; }
    .right-panel { display: flex; flex-direction: column; align-items: center; gap: 10px; }
    .info { font-size: 16px; font-weight: bold; }
    .battery { width: 60px; border: 2px solid #333; border-radius: 8px; padding: 5px; display: flex; flex-direction: column; gap: 4px; }
    .battery-cell { height: 15px; background-color: transparent; border: 1px solid #333; }
    .circle { width: 30px; height: 30px; border-radius: 50%; background-color: gray; }
    p.padding { margin-top: 0; margin-bottom: 0;}
    th.no-wrap {
        white-space: nowrap; /* 不換行 */
    }
    .event-box {
        width: 3px;
        height: 5px;
        display: inline-block; /* 讓方框與文字同一行 */
        margin-left: 8px;
        padding: 4px 8px;
        border: 1px solid #000;
    }
</style>
</head>
<body>
<div class="outer-container">
    <div class="tab-bar">
        <div class="bar-tab" onclick="closeTab()">
            <p class="padding">電瓶監控系統</p>
            <button class="close-btn" onclick="window.location.href='marine_main.html'">X</button>
        </div>
        <div class="bar-tab">
            <p id="header-title1" class="padding">Sys1-A11 電瓶</p>
            <button class="close-btn" onclick="history.back()">X</button>
        </div>
    </div>
</div>

<div class="tabs">
    <div class="tab active" id="header-title2">前艙 Sys1-A11 電瓶</div>
</div>

<div class="content-row">
    <table border="1" cellpadding="8">
        <tr><th class='no-wrap' id="table-title1">Sys1-A11</th><th>電池狀態</th><th>溫度警報</th><th>整流密度</th></tr>
        <tr>
            <td>狀態顯示</td>
            <td align="center"><div class="circle" id="circle1"></div></td>
            <td align="center"><div class="circle" id="circle2"></div></td>
            <td align="center"><div class="circle" id="circle3"></div></td>
        </tr>
    </table>
    <div class="right-panel">
        <div class="info" id="battery-soc">SOC=--%</div>
        <div class="info" id="battery-soh">SOH=--%</div>
    </div>
</div>

<div class="content-row">
    <table border="1" cellpadding="8">
        <tr><th id="table-title2">Sys1-A11</th><th>Cylinder</th><th>電瓶數據</th><th>事件報告&nbsp;<div class="event-box" id="event-box"></div></th></tr>
        <tr><td>單顆電瓶溫度</td><td>Temperature</td><td align="right">°C</td><td></td></tr>
        <tr><td>單顆電瓶電壓</td><td>Voltage</td><td align="right">V</td><td></td></tr>
        <tr><td>單顆整流密度</td><td></td><td align="right">kg/m³</td><td></td></tr>
    </table>
    <div class="right-panel">
        <div class="battery" id="battery">
            <div class="battery-cell"></div>
            <div class="battery-cell"></div>
            <div class="battery-cell"></div>
            <div class="battery-cell"></div>
            <div class="battery-cell"></div>
            <div class="battery-cell"></div>
        </div>
    </div>
</div>

<script>
    const params = new URLSearchParams(window.location.search);
    const text = params.get('text') || 'Sys1-A11';
    const color = params.get('color') || 'green';
    const soc = params.get('soc') || '--';
    const soh = params.get('soh') || '--';
    const fromPage = params.get('src') || '--';

    document.getElementById('header-title1').textContent = `${text} 電瓶`;
    document.getElementById('header-title2').textContent = `前艙 ${text} 電瓶`;
    document.getElementById('table-title1').textContent = text;
    document.getElementById('table-title2').textContent = text;

    const circles = [document.getElementById('circle1'), document.getElementById('circle2'), document.getElementById('circle3')];
    const eventBox = document.getElementById('event-box');
    const batteryCells = document.querySelectorAll('.battery-cell');

    let fillColor = 'green';
    let fillCount = 6;
    if (color === 'yellow') { fillColor = 'yellow'; fillCount = 3; }
    if (color === 'red') { fillColor = 'red'; fillCount = 1; }

    circles.forEach(c => c.style.backgroundColor = fillColor);
    eventBox.style.backgroundColor = fillColor;

    batteryCells.forEach((cell, index) => {
        cell.style.backgroundColor = index >= batteryCells.length - fillCount ? fillColor : 'transparent';
    });

    document.getElementById('battery-soc').textContent = `SOC=${soc}%`;
    document.getElementById('battery-soh').textContent = `SOH=${soh}%`;

    function closeTab() {
        if (fromPage == 'sys2') {
            window.location.href='battery_monitor2.html'
        } else {
            window.location.href='battery_monitor.html'
        }
    }
</script>
</body>
</html>